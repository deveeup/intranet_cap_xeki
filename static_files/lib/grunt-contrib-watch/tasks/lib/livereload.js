"use strict";var tinylr=require("tiny-lr"),servers=Object.create(null);module.exports=function(r){function e(e){e=!0===e?t:"number"==typeof e?{port:e}:r.util._.defaults(e,t),servers[e.port]?this.server=servers[e.port]:(this.server=tinylr(),this.server.server.removeAllListeners("error"),this.server.server.on("error",function(t){"EADDRINUSE"===t.code?r.fatal("Port "+e.port+" is already in use by another process."):r.fatal(t),process.exit(1)}),this.server.listen(e.port,function(t){if(t)return r.fatal(t);r.log.verbose.writeln("Live reload server started on port: "+e.port)}),servers[e.port]=this.server)}var t={port:35729};return e.prototype.trigger=function(e){r.log.verbose.writeln("Live reloading "+r.log.wordlist(e)+"..."),this.server.changed({body:{files:e}})},function(r){return new e(r)}};